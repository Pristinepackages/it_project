Bug fix by Ali
New feature added by umar